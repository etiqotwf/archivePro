const a0_0x4e242d=a0_0x5c46;(function(_0x40e3ec,_0x3f39d4){const _0x5685a1=a0_0x5c46,_0x40be86=_0x40e3ec();while(!![]){try{const _0x28399f=parseInt(_0x5685a1(0x253))/0x1+parseInt(_0x5685a1(0x1cc))/0x2*(parseInt(_0x5685a1(0x23d))/0x3)+parseInt(_0x5685a1(0x240))/0x4+-parseInt(_0x5685a1(0x273))/0x5*(parseInt(_0x5685a1(0x21b))/0x6)+-parseInt(_0x5685a1(0x1da))/0x7+parseInt(_0x5685a1(0x1c8))/0x8+parseInt(_0x5685a1(0x1b6))/0x9;if(_0x28399f===_0x3f39d4)break;else _0x40be86['push'](_0x40be86['shift']());}catch(_0x4e4b09){_0x40be86['push'](_0x40be86['shift']());}}}(a0_0x529c,0xa9d38));import{exec}from'child_process';import a0_0x3894ec from'fs';import a0_0x530a98 from'path';import a0_0x2884d1 from'sqlite3';import{fileURLToPath}from'url';import a0_0x2ecb98 from'cli-table3';import a0_0x2cb607 from'inquirer';import a0_0x5803c9 from'chalk';function a0_0x5c46(_0x57a692,_0x11be66){const _0x529c37=a0_0x529c();return a0_0x5c46=function(_0x5c46b5,_0x4ad418){_0x5c46b5=_0x5c46b5-0x16e;let _0x285fbb=_0x529c37[_0x5c46b5];return _0x285fbb;},a0_0x5c46(_0x57a692,_0x11be66);}import a0_0x58c86a from'figlet';import a0_0x52afa4 from'boxen';import a0_0xdc16eb from'ora';import a0_0x169807 from'terminal-kit';import a0_0x5abf25 from'gradient-string';import a0_0x31b209 from'mammoth';import a0_0x325c77 from'xlsx';import a0_0x3c400b from'pdf-parse';import{Document,Packer,Paragraph,TextRun}from'docx';import{transliterate}from'transliteration';import a0_0x8bc87a from'sharp';import{PDFDocument}from'pdf-lib';import{c}from'tar';import a0_0xe64f8e from'prompt-sync';import a0_0x43b257 from'crypto';import a0_0x3cde69 from'os';import a0_0x4a1bc0 from'archiver';const prompt=a0_0xe64f8e({'sigint':!![]}),tempDir=a0_0x4e242d(0x221),encryptionKey=a0_0x43b257[a0_0x4e242d(0x26b)](0x20),{terminal}=a0_0x169807,passwordFile=a0_0x530a98[a0_0x4e242d(0x18d)](process[a0_0x4e242d(0x179)](),a0_0x4e242d(0x1e3)),secretKey=a0_0x43b257[a0_0x4e242d(0x28e)](a0_0x4e242d(0x27c),a0_0x4e242d(0x28d),0x20),iv=Buffer[a0_0x4e242d(0x2ab)](0x10,0x0);function encrypt(_0x5e9c8f){const _0x3f10da=a0_0x4e242d,_0xcb2d2c=a0_0x43b257[_0x3f10da(0x175)](_0x3f10da(0x1d8),secretKey,iv);let _0x366f0f=_0xcb2d2c[_0x3f10da(0x24c)](_0x5e9c8f,_0x3f10da(0x1c6),'hex');return _0x366f0f+=_0xcb2d2c[_0x3f10da(0x2ac)](_0x3f10da(0x29a)),_0x366f0f;}function decrypt(_0x445322){const _0x31ddd1=a0_0x4e242d,_0x37db9b=a0_0x43b257['createDecipheriv'](_0x31ddd1(0x1d8),secretKey,iv);let _0x550e7b=_0x37db9b[_0x31ddd1(0x24c)](_0x445322,_0x31ddd1(0x29a),_0x31ddd1(0x1c6));return _0x550e7b+=_0x37db9b[_0x31ddd1(0x2ac)]('utf8'),_0x550e7b;}if(!a0_0x3894ec['existsSync'](passwordFile)){const defaultPassword={'password':encrypt(a0_0x4e242d(0x1f6))};a0_0x3894ec[a0_0x4e242d(0x278)](passwordFile,JSON['stringify'](defaultPassword,null,0x2),a0_0x4e242d(0x1c6)),console[a0_0x4e242d(0x2dc)]('✅\x20password.json\x20file\x20created\x20with\x20encrypted\x20password.');}else console['log'](a0_0x4e242d(0x20f));const __filename=fileURLToPath(import.meta[a0_0x4e242d(0x2f3)]),__dirname=a0_0x530a98[a0_0x4e242d(0x1f3)](__filename),dbPath=a0_0x530a98[a0_0x4e242d(0x18d)](__dirname,a0_0x4e242d(0x2b3)),dbExists=a0_0x3894ec[a0_0x4e242d(0x1f8)](dbPath),db=new a0_0x2884d1[(a0_0x4e242d(0x27a))](dbPath,_0x3eee60=>{const _0x19df2b=a0_0x4e242d;if(_0x3eee60)return;const _0x23ee2d=_0x19df2b(0x2eb);db[_0x19df2b(0x19b)](_0x23ee2d,_0x436471=>{const _0x467268=_0x19df2b;if(_0x436471)return;db[_0x467268(0x302)](_0x467268(0x259),(_0x3c8f88,_0x1fd186)=>{const _0x58f659=_0x467268;if(_0x3c8f88)return;const _0x25eb5b=_0x1fd186[_0x58f659(0x1b5)](_0x150f58=>_0x150f58[_0x58f659(0x1a9)]);!_0x25eb5b[_0x58f659(0x292)](_0x58f659(0x245))&&db['run']('ALTER\x20TABLE\x20archived_files\x20ADD\x20COLUMN\x20encryption_key\x20TEXT;',_0x242fb9=>{if(_0x242fb9)return;}),!_0x25eb5b[_0x58f659(0x292)](_0x58f659(0x24b))&&db[_0x58f659(0x19b)](_0x58f659(0x266),_0x1d96f1=>{if(_0x1d96f1)return;}),db[_0x58f659(0x20c)](_0x58f659(0x22f),(_0x19e2eb,_0x4cd956)=>{const _0x247aaa=_0x58f659;if(_0x19e2eb)return;if(_0x4cd956[_0x247aaa(0x2fb)]>0x0)return;else dbExists&&db[_0x247aaa(0x19b)](_0x247aaa(0x271),_0x52eb5c=>{const _0x47efb5=_0x247aaa;if(_0x52eb5c)return;db[_0x47efb5(0x19b)]('DELETE\x20FROM\x20sqlite_sequence\x20WHERE\x20name=\x27archived_files\x27',_0x4f85ad=>{if(_0x4f85ad)return;});});});});});}),archiveDir=a0_0x530a98[a0_0x4e242d(0x18d)](__dirname,a0_0x4e242d(0x2f4));!a0_0x3894ec[a0_0x4e242d(0x1f8)](archiveDir)&&a0_0x3894ec[a0_0x4e242d(0x16e)](archiveDir);function manageDatabase(){const _0xd2da27=a0_0x4e242d,_0x5efb15=fileURLToPath(import.meta[_0xd2da27(0x2f3)]),_0x3b23e5=a0_0x530a98[_0xd2da27(0x1f3)](_0x5efb15),_0xf304b6=a0_0x530a98[_0xd2da27(0x18d)](_0x3b23e5,_0xd2da27(0x2b3)),_0x591f18=a0_0x3894ec[_0xd2da27(0x1f8)](_0xf304b6),_0x51f226=new a0_0x2884d1[(_0xd2da27(0x27a))](_0xf304b6,_0x4e6a03=>{const _0x5cd4a5=_0xd2da27;if(_0x4e6a03){console[_0x5cd4a5(0x1d0)]('❌\x20Error\x20opening\x20database:',_0x4e6a03['message']);return;}console[_0x5cd4a5(0x2dc)]('✅\x20Database\x20opened\x20successfully.');const _0x5a26ee=_0x5cd4a5(0x235);_0x51f226[_0x5cd4a5(0x19b)](_0x5a26ee,_0x2a47e3=>{const _0x493346=_0x5cd4a5;if(_0x2a47e3){console['error']('❌\x20Error\x20creating\x20table:',_0x2a47e3[_0x493346(0x25d)]);return;}console[_0x493346(0x2dc)](_0x493346(0x23c)),_0x51f226[_0x493346(0x302)](_0x493346(0x259),(_0x32f982,_0x4a1a2e)=>{const _0x237506=_0x493346;if(_0x32f982){console[_0x237506(0x1d0)](_0x237506(0x29b),_0x32f982[_0x237506(0x25d)]);return;}const _0x460efe=_0x4a1a2e['map'](_0x36bfc1=>_0x36bfc1[_0x237506(0x1a9)]);!_0x460efe['includes'](_0x237506(0x245))&&_0x51f226['run'](_0x237506(0x1dd),_0x2b7a47=>{const _0x19aa60=_0x237506;_0x2b7a47?console[_0x19aa60(0x1d0)](_0x19aa60(0x23b),_0x2b7a47[_0x19aa60(0x25d)]):console[_0x19aa60(0x2dc)](_0x19aa60(0x170));}),!_0x460efe[_0x237506(0x292)](_0x237506(0x24b))&&_0x51f226[_0x237506(0x19b)]('ALTER\x20TABLE\x20archived_files\x20ADD\x20COLUMN\x20encrypted_data\x20BLOB;',_0x4b81e2=>{const _0x281ede=_0x237506;_0x4b81e2?console['error'](_0x281ede(0x224),_0x4b81e2[_0x281ede(0x25d)]):console[_0x281ede(0x2dc)](_0x281ede(0x272));}),_0x591f18&&(console[_0x237506(0x2dc)](_0x237506(0x1ed)),_0x51f226[_0x237506(0x19b)](_0x237506(0x271),_0x55f0b3=>{const _0x3b0d0f=_0x237506;if(_0x55f0b3){console['error'](_0x3b0d0f(0x25a),_0x55f0b3[_0x3b0d0f(0x25d)]);return;}console[_0x3b0d0f(0x2dc)](_0x3b0d0f(0x289)),_0x51f226[_0x3b0d0f(0x19b)](_0x3b0d0f(0x29c),_0x2b4022=>{const _0x4c2eff=_0x3b0d0f;_0x2b4022?console[_0x4c2eff(0x1d0)](_0x4c2eff(0x2f0),_0x2b4022['message']):console['log'](_0x4c2eff(0x1d3));});const _0x22fde5=a0_0x530a98[_0x3b0d0f(0x18d)](_0x3b23e5,'archive');a0_0x3894ec['existsSync'](_0x22fde5)&&(a0_0x3894ec[_0x3b0d0f(0x222)](_0x22fde5,{'recursive':!![],'force':!![]}),console[_0x3b0d0f(0x2dc)](_0x3b0d0f(0x25e)+_0x22fde5));}));});});}),_0x3493b8=a0_0x530a98[_0xd2da27(0x18d)](_0x3b23e5,_0xd2da27(0x2f4));console[_0xd2da27(0x2dc)](_0xd2da27(0x260)+_0x3493b8),!a0_0x3894ec[_0xd2da27(0x1f8)](_0x3493b8)&&(a0_0x3894ec['mkdirSync'](_0x3493b8),console['log']('✅\x20Created\x20directory:\x20'+_0x3493b8));}function openFile(_0x4c51cc){const _0x2b959d=a0_0x4e242d;db[_0x2b959d(0x20c)](_0x2b959d(0x2d2),[_0x4c51cc],(_0xce8b5,_0x54bb2)=>{const _0x4407f9=_0x2b959d;if(_0xce8b5)return console[_0x4407f9(0x1d0)](_0x4407f9(0x1de),_0xce8b5[_0x4407f9(0x25d)]);if(!_0x54bb2)return console[_0x4407f9(0x2dc)](_0x4407f9(0x275));const _0x2610a0=_0x54bb2[_0x4407f9(0x2ce)],_0x3d274e=a0_0x530a98[_0x4407f9(0x189)](_0x2610a0,'.enc'),_0x2cee6d=a0_0x530a98[_0x4407f9(0x18d)](archiveDir,_0x3d274e),_0x5213aa=Buffer[_0x4407f9(0x192)](_0x54bb2[_0x4407f9(0x245)],'hex'),_0xb67c01=Buffer[_0x4407f9(0x2ab)](0x10,0x0),_0x3e0d16=()=>{return new Promise((_0x1ab08c,_0x1ab310)=>{const _0x4aa987=a0_0x5c46,_0x2f055a=a0_0x43b257[_0x4aa987(0x2ef)](_0x4aa987(0x1d8),_0x5213aa,_0xb67c01),_0xfd0d=a0_0x3894ec[_0x4aa987(0x234)](_0x2610a0),_0x54f041=a0_0x3894ec[_0x4aa987(0x295)](_0x2cee6d);_0xfd0d[_0x4aa987(0x28b)](_0x2f055a)[_0x4aa987(0x28b)](_0x54f041),_0x54f041['on'](_0x4aa987(0x2be),_0x1ab08c),_0x54f041['on']('error',_0x1ab310),_0xfd0d['on'](_0x4aa987(0x1d0),_0x1ab310);});},_0x5aee34=()=>{return new Promise((_0x333f90,_0x5546e3)=>{const _0xb2054e=a0_0x5c46,_0x2fff87=a0_0x43b257[_0xb2054e(0x175)](_0xb2054e(0x1d8),_0x5213aa,_0xb67c01),_0x484daa=a0_0x3894ec[_0xb2054e(0x234)](_0x2cee6d),_0x4a7ecb=a0_0x3894ec['createWriteStream'](_0x2610a0);_0x484daa['pipe'](_0x2fff87)[_0xb2054e(0x28b)](_0x4a7ecb),_0x4a7ecb['on'](_0xb2054e(0x2be),()=>{const _0x2d0a9e=_0xb2054e;exec('powershell\x20-Command\x20\x22Remove-Item\x20-Path\x20\x27'+_0x2cee6d+_0x2d0a9e(0x180),_0x12d3e3=>{const _0x5c8a03=_0x2d0a9e;_0x12d3e3?console[_0x5c8a03(0x1d0)](_0x5c8a03(0x288),_0x12d3e3['message']):console['log'](_0x5c8a03(0x191)+_0x2cee6d),_0x333f90();});}),_0x4a7ecb['on'](_0xb2054e(0x1d0),_0x5546e3),_0x484daa['on'](_0xb2054e(0x1d0),_0x5546e3);});};_0x3e0d16()['then'](()=>{const _0x31208a=_0x4407f9;console[_0x31208a(0x2dc)](_0x31208a(0x1bb)+_0x2cee6d);let _0x5b57b8;const _0xfd9563=Date['now']();try{_0x5b57b8=exec('\x22'+_0x2cee6d+'\x22');}catch(_0x4f8743){console[_0x31208a(0x1b1)](_0x31208a(0x20a)),setTimeout(_0x5aee34,0xea60);return;}_0x5b57b8['on'](_0x31208a(0x1a1),()=>{const _0x5bfcaf=_0x31208a,_0x2a7a10=(Date[_0x5bfcaf(0x210)]()-_0xfd9563)/0x3e8;_0x2a7a10<0x5?(console[_0x5bfcaf(0x1b1)](_0x5bfcaf(0x1e9)),setTimeout(_0x5aee34,0x7530)):(console['log']('📁\x20Media\x20app\x20closed.\x20Starting\x20encryption...'),_0x5aee34());}),setTimeout(()=>{const _0x26c48b=_0x31208a;a0_0x3894ec[_0x26c48b(0x1f8)](_0x2cee6d)&&(console[_0x26c48b(0x1b1)](_0x26c48b(0x218)),_0x5aee34());},0x5*0x3c*0x3e8);})['catch'](_0x1e3972=>{const _0x4b2770=_0x4407f9;console['error'](_0x4b2770(0x2d1),_0x1e3972);});});}function a0_0x529c(){const _0x15bcbc=['toFixed','keyword','ALTER\x20TABLE\x20archived_files\x20ADD\x20COLUMN\x20encryption_key\x20TEXT;','❌\x20Error\x20retrieving\x20file:','🔐\x20Enter\x20new\x20password:\x20','\x0aExiting...\x0a','📜\x20Name:\x20','✅\x20File\x20renamed\x20to:','password.json','⚠️\x20Unsupported\x20file\x20type:\x20','File\x20Manager','stringify','changePassword','🖥️\x20Enter\x20file\x20ID\x20to\x20open:','⚠️\x20Player\x20closed\x20too\x20quickly.\x20Scheduling\x20delayed\x20re-encryption...','xlsx','🗂️\x20Extension:\x20','.gif','🗑️\x20Deleting\x20all\x20entries...','isFile','Enter\x20the\x20output\x20PDF\x20file\x20name:','textSync','gray','\x1b[1m\x1b[36m[3]\x20[L]\x20List\x20archived\x20files\x1b[0m','dirname','⏳\x20المدة','❌\x20Error\x20during\x20encryption:','1234','\x0a🔍\x20Searching\x20for\x20files...\x0a','existsSync','types','\x1b[1m\x1b[37m[x]\x20[E]\x20Exit\x1b[0m','INSERT\x20INTO\x20archived_files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_name,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_extension,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_size,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20original_path,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20archived_path,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20encryption_key,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20encrypted_data\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','❌\x20Error\x20deleting\x20file:','.jpeg','other','\x0a📂\x20Archiving\x20a\x20folder...\x0a','toLowerCase','create','🔄\x20Waiting\x20for\x20file\x20to\x20be\x20closed...\x20Attempt\x20','en-GB','slice','\x20KB','./scanner_output','SELECT\x20archived_path\x20FROM\x20archived_files\x20WHERE\x20id\x20=\x20?','createHash','\x0a🔑\x20Changing\x20password...\x0a','⚠️\x20Failed\x20to\x20launch\x20player,\x20will\x20re-encrypt\x20after\x20timeout.','clear','get','⚠️\x20No\x20images\x20or\x20PDF\x20files\x20found\x20in\x20this\x20folder.','cyan','📄\x20password.json\x20already\x20exists.','now','No\x20content\x20to\x20display.','resolve','\x0a📂\x20Searching\x20inside\x20a\x20file...\x0a','❌\x20Error\x20saving\x20to\x20DB:','Enter\x20the\x20folder\x20path\x20containing\x20images:','⚧\x20الاقامة','📄\x20Do\x20you\x20want\x20to\x20open\x20the\x20search\x20results\x20file?\x20Here\x20are\x20the\x20details:','⚠️\x20Fallback\x20triggered:\x20forcing\x20re-encryption\x20after\x20timeout.','.png','\x20Designed\x20by\x20Ahmed\x20Amer\x0a','1426416MewRPZ','width','SELECT\x20*\x20FROM\x20archived_files\x20WHERE\x20id\x20=\x20?','\x20|\x20TXT:\x20','\x20Total:\x20','💼\x20الوظيفة','temp','rmSync','---------------------------------------\x0a','❌\x20Error\x20adding\x20encrypted_data\x20column:','EBUSY','test','❌\x20Error\x20saving\x20record\x20to\x20database:','delete','\x1b[1m\x1b[38;5;214m[12]\x20[DB]\x20Reset\x20database\x1b[0m','search_results.txt','Desktop','copyPages','\x0aPress\x20ENTER\x20to\x20return\x20to\x20the\x20main\x20menu...','\x20|\x20Excel:\x20','SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20archived_files','grabInput','toDate','Do\x20you\x20want\x20to\x20create\x20a\x20backup\x20of\x20the\x20archive\x20folder?','code','createReadStream','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20archived_files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_extension\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20original_path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20archived_path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20archived_at\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x1b[1m\x1b[38;5;220m[10]\x20[X]\x20Delete\x20a\x20file\x1b[0m','default','./archive','🔐\x20Confirm\x20new\x20password:\x20','🔑\x20Please\x20Enter\x20Password\x20:\x20','❌\x20Error\x20adding\x20encryption_key\x20column:','✅\x20Table\x20\x27archived_files\x27\x20checked/created\x20successfully.','753GMaUSC','\x0a────────────────────────────────────────────\x0a','fromDate','22564fOrmIV','.xlsx','yellowBright','✅\x20Image\x20converted\x20to\x20PDF:\x20','ID\x20','encryption_key','\x1b[1m\x1b[33m[2]\x20[AF]\x20Archive\x20a\x20Folder\x1b[0m','❌\x20General\x20archiving\x20error:','restore','push','🔍\x20Retrieved\x20','encrypted_data','update','📄\x20File\x20Content:\x0a','❌\x20Error\x20searching\x20records:','❌\x20Error\x20opening\x20file:\x20','.xls','input','.docx','636548XQDWdS','❌\x20No\x20valid\x20files\x20selected.','❌\x20Error\x20restoring\x20file:','\x20\x20|\x20\x20(N)\x20Name:\x20','readFile','data','PRAGMA\x20table_info(archived_files);','❌\x20Error\x20deleting\x20records:','oldPassword','toString','message','✅\x20Deleted\x20archive\x20directory:\x20','SELECT\x20*\x20FROM\x20archived_files','📂\x20Archive\x20directory:\x20','❌\x20Wrong\x20Password','center','open','archiveFolder','Size\x20(KB)','ALTER\x20TABLE\x20archived_files\x20ADD\x20COLUMN\x20encrypted_data\x20BLOB;','unlinkSync','openSync','file_size','✅\x20File\x20decrypted\x20and\x20verified\x20successfully.','randomBytes','\x0a\x20\x20\x20\x20[Console]::OutputEncoding\x20=\x20[System.Text.Encoding]::UTF8;\x0a\x20\x20\x20\x20Add-Type\x20-AssemblyName\x20System.Windows.Forms;\x0a\x20\x20\x20\x20$dialog\x20=\x20New-Object\x20System.Windows.Forms.OpenFileDialog;\x0a\x20\x20\x20\x20$dialog.Filter\x20=\x20\x27All\x20Files\x20(*.*)|*.*\x27;\x0a\x20\x20\x20\x20$dialog.Multiselect\x20=\x20$true;\x0a\x20\x20\x20\x20$result\x20=\x20$dialog.ShowDialog();\x0a\x20\x20\x20\x20if\x20($result\x20-eq\x20[System.Windows.Forms.DialogResult]::OK)\x20{\x0a\x20\x20\x20\x20\x20\x20$dialog.FileNames\x0a\x20\x20\x20\x20}\x0a\x20\x20','embedPng','\x20|\x20DOCX:\x20','🔍\x20Enter\x20keywords\x20(comma-separated):','json_to_sheet','DELETE\x20FROM\x20archived_files','✅\x20encrypted_data\x20column\x20added\x20successfully.','5xagjJD','writeFile','❌\x20File\x20not\x20found.','\x20AND\x20date(archived_at)\x20>=\x20date(?)','\x20\x20|\x20\x20(S)\x20Size:\x20','writeFileSync','❌\x20The\x20Excel\x20file\x20is\x20still\x20open\x20after\x20multiple\x20attempts.\x20Update\x20canceled.','Database','powershell\x20-NoProfile\x20-Command\x20\x22','mySuperSecretKey','❌\x20Folder\x20does\x20not\x20exist.','drawImage','❌\x20Not\x20a\x20valid\x20folder:','book_new','✅\x20Password\x20changed\x20successfully.','search','✅\x20Folder\x20archived\x20successfully.','readdirSync','Error\x20reading\x20archive\x20directory:','📏\x20Size:\x20','🗑️\x20Unencrypted\x20ZIP\x20file\x20removed:','❌\x20Failed\x20to\x20delete\x20decrypted\x20file:','✅\x20All\x20records\x20deleted.','docx','pipe','.jpg','salt','scryptSync','✅\x20File\x20deleted\x20permanently.','Sheets','\x20KB\x0a','includes','archived_at',')\x20-\x20Total:\x20','createWriteStream','📄\x20Original\x20file\x20remains\x20unchanged:\x20','password','\x0a📄\x20Converting\x20PDF\x20↔\x20DOCX...\x0a','❌\x20Error\x20fetching\x20records:\x20','hex','❌\x20Error\x20checking\x20table\x20schema:','DELETE\x20FROM\x20sqlite_sequence\x20WHERE\x20name=\x27archived_files\x27','Path','total','blue','\x20|\x20Other:\x20','split','closeSync','greenBright','Error\x20creating\x20backup:\x20','magenta','🔍\x20Enter\x20search\x20keyword\x20(name,\x20date,\x20extension,\x20path,\x20or\x20content):','📅\x20تاريخ\x20ووقت\x20التسجيل','trim','📦\x20Fetching\x20archived\x20files...','list','alloc','final','toLocaleTimeString','original_path','succeed','backup','en-US','📂\x20🔍\x20Search\x20Results\x20(','archive.db','⚠️\x20No\x20matching\x20files\x20found.','❌\x20Error\x20setting\x20up\x20encryption\x20stream:','\x20\x20|\x20\x20(E)\x20Extension:\x20','✅\x20Backup\x20created\x20successfully\x20at\x20','✅\x20PDF\x20created\x20successfully:\x20','.json','bold','🔄\x20Enter\x20file\x20ID\x20to\x20restore:','lastID','toLocaleDateString','finish','📍\x20Path:\x20','\x20|\x20Images:\x20','underline','close','\x0a💾\x20Creating\x20a\x20backup...\x0a','forEach','pastel','\x20AND\x20date(archived_at)\x20<=\x20date(?)','\x20|\x20','\x20AND\x20file_size\x20>=\x20?','zip','Big','📁\x20Folder\x20archived\x20and\x20saved\x20in\x20DB\x20(ID:\x20','sheet_to_json','---------------------------------------','archived_path','📂\x20File\x20record\x20saved\x20in\x20database\x20(ID:\x20','🔐\x20Enter\x20current\x20password:\x20','❌\x20Error\x20decrypting\x20or\x20opening\x20file:','SELECT\x20archived_path,\x20encryption_key\x20FROM\x20archived_files\x20WHERE\x20id\x20=\x20?','📍\x20Path','✅\x20Folder\x20zipped\x20and\x20encrypted\x20as:','G:/Backup/ArchiveBackup','button','white','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20*\x20FROM\x20archived_files\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20(file_name\x20LIKE\x20?\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OR\x20file_extension\x20LIKE\x20?\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OR\x20archived_at\x20LIKE\x20?\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OR\x20archived_path\x20LIKE\x20?)\x0a\x20\x20\x20\x20','✅\x20File\x20successfully\x20encrypted\x20and\x20archived\x20as:\x20','#FF4500','outputFileName','log','statSync','jpeg','extractRawText','PDF','sort','\x20rows.','📧\x20الإدارة','restoreDatabase','.pdf','pdf','restoreDb','createPdf','Extension','⚠️\x20Enter\x20file\x20ID\x20to\x20delete:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20archived_files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_extension\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20file_size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20original_path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20archived_path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20archived_at\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20\x20\x20\x20\x20)\x0a\x20\x20\x20\x20','\x1b[1m\x1b[38;5;51m[9]\x20[R]\x20Restore\x20a\x20file\x1b[0m','🎓\x20المؤهل','.enc','createDecipheriv','❌\x20Error\x20resetting\x20AUTOINCREMENT:','Do\x20you\x20want\x20to\x20restore\x20the\x20database?','👤\x20الاسم','url','archive','readFileSync','xls','filter','confirm','yellow','❌\x20Error\x20updating\x20Excel\x20file:','count','!cols','height','book_append_sheet','\x1b[1m\x1b[38;5;154m[5]\x20[SI]\x20Search\x20inside\x20a\x20file\x1b[0m','🔐\x20Encrypting...','toLocaleString','all','\x1b[1m\x1b[38;5;228m[11]\x20[B]\x20Backup\x20the\x20archive\x20folder\x1b[0m','INSERT\x20INTO\x20archived_files\x20(file_name,\x20file_extension,\x20file_size,\x20original_path,\x20archived_path,\x20encryption_key,\x20encrypted_data)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','end','jpg','🚫\x20Deletion\x20cancelled.','\x1b[1m\x1b[38;5;159m[7]\x20[PDF]\x20Create\x20PDF\x20from\x20images\x1b[0m','utils','mkdirSync','each','✅\x20encryption_key\x20column\x20added\x20successfully.','📅\x20From\x20date\x20(YYYY-MM-DD)\x20[optional]:','multiline','homedir','getPageIndices','createCipheriv','📂\x20Search\x20results\x20saved\x20in:\x20','❌\x20Incorrect\x20current\x20password.','\x20|\x20Database\x20Size:\x20','cwd','🗂️\x20Ext','folderPath','✅\x20PDF\x20created\x20successfully\x20at\x20','\x20files\x0a','isDirectory','finalize','\x27\x20-Force\x22','red','SheetNames','size','\x0a\x20\x20\x20\x20\x20\x20[Console]::OutputEncoding\x20=\x20[System.Text.Encoding]::UTF8;\x0a\x20\x20\x20\x20\x20\x20Add-Type\x20-AssemblyName\x20System.Windows.Forms;\x0a\x20\x20\x20\x20\x20\x20$dialog\x20=\x20New-Object\x20System.Windows.Forms.FolderBrowserDialog;\x0a\x20\x20\x20\x20\x20\x20$dialog.Description\x20=\x20\x27Select\x20a\x20folder\x20to\x20archive\x27;\x0a\x20\x20\x20\x20\x20\x20$result\x20=\x20$dialog.ShowDialog();\x0a\x20\x20\x20\x20\x20\x20if\x20($result\x20-eq\x20[System.Windows.Forms.DialogResult]::OK)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20$dialog.SelectedPath\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','\x20MB\x20|\x20','minSizeKB','Name','DELETE\x20FROM\x20archived_files\x20WHERE\x20id\x20=\x20?','basename','Archived\x20Files','\x20No\x20files\x20found\x20in\x20archive.','toBuffer','join','🆔\x20ID','📚\x20الدورة','newPassword','✅\x20Decrypted\x20file\x20deleted\x20successfully:\x20','from','start','replace','❌\x20Error\x20deleting\x20record:','every','\x1b[1m\x1b[38;5;49m[6]\x20[C]\x20Convert\x20PDF\x20↔\x20DOCX\x1b[0m','EPERM','\x1b[1m\x1b[38;5;10m[4]\x20[S]\x20Search\x20for\x20files\x1b[0m','table','run','openFile','rename','folder','txt','addPage','exit','❌\x20Error\x20selecting\x20files:','✅\x20Conversion\x20successful:\x20','=======================================\x0a','sha256','getHeight','file_name','📅\x20Folder:\x20','name','pause','outputPdf','.zip','\x0a📄\x20Listing\x20archived\x20files...\x0a','📦\x20Zipping\x20folder...','\x1b[1m\x1b[38;5;183m[13]\x20[P]\x20Change\x20Password\x1b[0m','folderName','warn','❌\x20Error\x20during\x20writing\x20file:','📜\x20Name','getWidth','map','4558419hIDkNl','length','green','text','file_extension','✅\x20File\x20successfully\x20decrypted:\x20','📅\x20To\x20date\x20(YYYY-MM-DD)\x20[optional]:','=======================================\x0a\x0a','embedJpg','lightRounded','convert','✅\x20Excel\x20file\x20updated\x20successfully:\x20','SELECT\x20id,\x20archived_path,\x20encryption_key\x20FROM\x20archived_files','❌\x20Error\x20processing\x20file\x20','EACCES','📏\x20Maximum\x20file\x20size\x20in\x20KB\x20[optional]:','utf8','prompt','8606096sTYwXC','\x20KB\x20\x20|\x20\x20(F)\x20Folder:\x20','blueBright','📅\x20Date\x20Archived:\x20','734wwxOgG','extname','❌\x20Passwords\x20do\x20not\x20match.','merged_output.pdf','error','🆔\x20','directory','✅\x20AUTOINCREMENT\x20reset\x20successfully.','❌\x20Error\x20completing\x20fetch:\x20','searchInside','\x0a📁\x20Archiving\x20a\x20secure\x20file...\x0a','#FFA500','aes-256-cbc','❌\x20Error\x20renaming\x20file:','9682505GhmUgS'];a0_0x529c=function(){return _0x15bcbc;};return a0_0x529c();}async function searchFiles(){const _0x514ccc=a0_0x4e242d,{keyword:_0x174a0d,fromDate:_0x14849b,toDate:_0x420cbc,minSizeKB:_0x42a12d,maxSizeKB:_0x64690f}=await a0_0x2cb607['prompt']([{'type':_0x514ccc(0x251),'name':_0x514ccc(0x1dc),'message':_0x514ccc(0x2a6)},{'type':_0x514ccc(0x251),'name':_0x514ccc(0x23f),'message':_0x514ccc(0x171)},{'type':_0x514ccc(0x251),'name':_0x514ccc(0x231),'message':_0x514ccc(0x1bc)},{'type':_0x514ccc(0x251),'name':_0x514ccc(0x186),'message':'📏\x20Minimum\x20file\x20size\x20in\x20KB\x20[optional]:'},{'type':_0x514ccc(0x251),'name':'maxSizeKB','message':_0x514ccc(0x1c5)}]),_0x53c502=_0x42a12d?parseInt(_0x42a12d)*0x400:null,_0x1f9798=_0x64690f?parseInt(_0x64690f)*0x400:null;let _0x172aa2=_0x514ccc(0x2d8),_0x285e0e=Array(0x4)['fill']('%'+_0x174a0d+'%');_0x14849b&&(_0x172aa2+=_0x514ccc(0x276),_0x285e0e['push'](_0x14849b));_0x420cbc&&(_0x172aa2+=_0x514ccc(0x2c6),_0x285e0e['push'](_0x420cbc));_0x53c502&&(_0x172aa2+=_0x514ccc(0x2c8),_0x285e0e['push'](_0x53c502));_0x1f9798&&(_0x172aa2+='\x20AND\x20file_size\x20<=\x20?',_0x285e0e[_0x514ccc(0x249)](_0x1f9798));try{let _0x4e8be7=await new Promise((_0x5c65c6,_0x1ddf69)=>{const _0x13552f=_0x514ccc;db[_0x13552f(0x302)](_0x172aa2,_0x285e0e,(_0xb9b69a,_0x802f9f)=>{if(_0xb9b69a)_0x1ddf69(_0xb9b69a);else _0x5c65c6(_0x802f9f);});});if(_0x4e8be7[_0x514ccc(0x1b7)]===0x0){console[_0x514ccc(0x2dc)](a0_0x5803c9[_0x514ccc(0x2f9)]('⚠️\x20No\x20matching\x20files\x20found.'));return;}let _0x22485a='=======================================\x0a';_0x22485a+=_0x514ccc(0x2b2)+new Date()[_0x514ccc(0x301)](_0x514ccc(0x2b1))+_0x514ccc(0x294)+_0x4e8be7['length']+_0x514ccc(0x17d),_0x22485a+=_0x514ccc(0x1bd);const _0x934bf8=new a0_0x2ecb98({'head':[a0_0x5803c9[_0x514ccc(0x2d7)](_0x514ccc(0x18e)),a0_0x5803c9[_0x514ccc(0x2d7)](_0x514ccc(0x1b3)),a0_0x5803c9['white'](_0x514ccc(0x17a)),a0_0x5803c9['white']('📏\x20Size\x20(KB)'),a0_0x5803c9[_0x514ccc(0x2d7)]('📅\x20Date\x20Archived'),a0_0x5803c9[_0x514ccc(0x2d7)](_0x514ccc(0x2d3))],'colWidths':[0x5,0x19,0x8,0xc,0x12,0x32],'wordWrap':!![]});for(let _0x911e4b of _0x4e8be7){_0x934bf8[_0x514ccc(0x249)]([_0x911e4b['id'],_0x911e4b[_0x514ccc(0x1a7)],_0x911e4b[_0x514ccc(0x1ba)],(_0x911e4b[_0x514ccc(0x269)]/0x400)[_0x514ccc(0x1db)](0x2),_0x911e4b[_0x514ccc(0x293)],_0x911e4b['archived_path']]),_0x22485a+=_0x514ccc(0x1d1)+_0x911e4b['id']+'\x0a',_0x22485a+=_0x514ccc(0x1e1)+_0x911e4b[_0x514ccc(0x1a7)]+'\x0a',_0x22485a+=_0x514ccc(0x1eb)+_0x911e4b[_0x514ccc(0x1ba)]+'\x0a',_0x22485a+=_0x514ccc(0x286)+(_0x911e4b['file_size']/0x400)['toFixed'](0x2)+_0x514ccc(0x291),_0x22485a+=_0x514ccc(0x1cb)+_0x911e4b[_0x514ccc(0x293)]+'\x0a',_0x22485a+=_0x514ccc(0x2bf)+_0x911e4b[_0x514ccc(0x2ce)]+'\x0a',_0x22485a+='---------------------------------------\x0a';}console['log'](_0x934bf8[_0x514ccc(0x25c)]());const _0x443787='search_results.txt';a0_0x3894ec['writeFileSync'](_0x443787,_0x22485a,'utf8'),console['log'](a0_0x5803c9[_0x514ccc(0x29f)](_0x514ccc(0x176)+_0x443787));const {openFile:_0x55e8f0}=await a0_0x2cb607['prompt']([{'type':_0x514ccc(0x2f8),'name':_0x514ccc(0x19c),'message':'📄\x20Do\x20you\x20want\x20to\x20open\x20the\x20search\x20results\x20file?','default':![]}]);_0x55e8f0&&exec('\x22'+_0x443787+'\x22',_0x4327c9=>{const _0x5bea1d=_0x514ccc;_0x4327c9&&console[_0x5bea1d(0x1d0)](a0_0x5803c9[_0x5bea1d(0x181)](_0x5bea1d(0x24f)+_0x443787));});}catch(_0x5c5549){console['error'](a0_0x5803c9[_0x514ccc(0x181)]('❌\x20Error\x20searching\x20records:'),_0x5c5549[_0x514ccc(0x25d)]);}}const excelFilePath=a0_0x530a98[a0_0x4e242d(0x18d)](archiveDir,'archived_files.xlsx');function isFileLocked(_0x3696f7){const _0x36d0=a0_0x4e242d;try{const _0x2377c6=a0_0x3894ec[_0x36d0(0x268)](_0x3696f7,'r+');return a0_0x3894ec[_0x36d0(0x2a2)](_0x2377c6),![];}catch(_0x138e8d){if(_0x138e8d[_0x36d0(0x233)]===_0x36d0(0x225)||_0x138e8d['code']===_0x36d0(0x198)||_0x138e8d[_0x36d0(0x233)]===_0x36d0(0x1c4))return!![];throw _0x138e8d;}}async function waitForFileToUnlock(_0x388dc1,_0x4c4f66=0x32,_0x278a19=0x2710){const _0x162691=a0_0x4e242d;for(let _0x27e058=0x0;_0x27e058<_0x4c4f66;_0x27e058++){if(!isFileLocked(_0x388dc1))return!![];console[_0x162691(0x2dc)](_0x162691(0x202)+(_0x27e058+0x1)+'/'+_0x4c4f66),await new Promise(_0x3d13a1=>setTimeout(_0x3d13a1,_0x278a19));}return![];}async function updateExcelFile(_0x3a2426){const _0x22624e=a0_0x4e242d;try{if(a0_0x3894ec[_0x22624e(0x1f8)](excelFilePath)){const _0x13fab6=await waitForFileToUnlock(excelFilePath);if(!_0x13fab6){console['error'](_0x22624e(0x279));return;}}let _0x2779d5,_0x51c3a8,_0xe92538=[];if(a0_0x3894ec['existsSync'](excelFilePath)){_0x2779d5=a0_0x325c77[_0x22624e(0x257)](excelFilePath);const _0x3c007e=_0x2779d5[_0x22624e(0x182)][0x0];_0x51c3a8=_0x2779d5[_0x22624e(0x290)][_0x3c007e],_0x51c3a8&&(_0xe92538=a0_0x325c77['utils'][_0x22624e(0x2cc)](_0x51c3a8));}else _0x2779d5=a0_0x325c77[_0x22624e(0x309)][_0x22624e(0x280)]();_0x3a2426['id']=_0xe92538['length']+0x1,_0x3a2426['archive_date']=new Date()['toLocaleString'](_0x22624e(0x203)),delete _0x3a2426[_0x22624e(0x245)],delete _0x3a2426[_0x22624e(0x24b)],_0xe92538[_0x22624e(0x249)](_0x3a2426),_0x51c3a8=a0_0x325c77[_0x22624e(0x309)][_0x22624e(0x270)](_0xe92538),_0x51c3a8[_0x22624e(0x2fc)]=[{'wch':0x14},{'wch':0xc},{'wch':0xc},{'wch':0xf},{'wch':0x2d},{'wch':0x14},{'wch':0x5}],_0x2779d5[_0x22624e(0x182)][_0x22624e(0x1b7)]>0x0&&(_0x2779d5[_0x22624e(0x182)]['forEach'](_0xa61a18=>{delete _0x2779d5['Sheets'][_0xa61a18];}),_0x2779d5[_0x22624e(0x182)]=[]),a0_0x325c77['utils'][_0x22624e(0x2fe)](_0x2779d5,_0x51c3a8,_0x22624e(0x18a)),a0_0x325c77[_0x22624e(0x274)](_0x2779d5,excelFilePath),console[_0x22624e(0x2dc)](_0x22624e(0x1c1)+excelFilePath);}catch(_0x26f8a3){console[_0x22624e(0x1d0)](_0x22624e(0x2fa),_0x26f8a3);}}export async function archiveFile(_0xbd511e){const _0x586a52=a0_0x4e242d,_0x494108=a0_0x530a98[_0x586a52(0x189)](_0xbd511e),_0x2fe385=_0x494108+'.enc',_0x149584=a0_0x530a98['join'](archiveDir,_0x2fe385),_0x5c966b=a0_0x530a98['extname'](_0x494108)['slice'](0x1),_0x39b568=a0_0x3894ec[_0x586a52(0x2dd)](_0xbd511e)['size'];try{const _0x7ee457=a0_0x43b257[_0x586a52(0x175)](_0x586a52(0x1d8),encryptionKey,Buffer['alloc'](0x10,0x0)),_0x157ce5=a0_0x3894ec[_0x586a52(0x234)](_0xbd511e),_0x2fb209=a0_0x3894ec[_0x586a52(0x295)](_0x149584);_0x157ce5['pipe'](_0x7ee457)[_0x586a52(0x28b)](_0x2fb209),_0x2fb209['on'](_0x586a52(0x2be),()=>{const _0x421a32=_0x586a52;console[_0x421a32(0x2dc)](_0x421a32(0x2d9)+_0x2fe385),console[_0x421a32(0x2dc)](_0x421a32(0x296)+_0xbd511e),db[_0x421a32(0x19b)](_0x421a32(0x304),[_0x494108,_0x5c966b,_0x39b568,_0xbd511e,_0x149584,encryptionKey[_0x421a32(0x25c)]('hex'),null],function(_0x1cec42){const _0xebfaa0=_0x421a32;_0x1cec42?console[_0xebfaa0(0x1d0)](_0xebfaa0(0x227),_0x1cec42[_0xebfaa0(0x25d)]):(console[_0xebfaa0(0x2dc)](_0xebfaa0(0x2cf)+this['lastID']+')'),updateExcelFile({'file_name':_0x494108,'file_extension':_0x5c966b,'file_size':_0x39b568,'original_path':_0xbd511e,'archived_path':_0x149584,'archive_date':new Date()[_0xebfaa0(0x301)](_0xebfaa0(0x203))}));});}),_0x2fb209['on'](_0x586a52(0x1d0),_0x1613f8=>{const _0xc47823=_0x586a52;console[_0xc47823(0x1d0)](_0xc47823(0x1b2),_0x1613f8);});}catch(_0x16e018){console['error'](_0x586a52(0x2b5),_0x16e018);}}function zipFolder(_0x492aaa,_0x242b32){return new Promise((_0x4b1d48,_0x18dde0)=>{const _0x50d111=a0_0x5c46,_0xe85b04=a0_0x3894ec['createWriteStream'](_0x242b32),_0xa161e4=a0_0x4a1bc0(_0x50d111(0x2c9),{'zlib':{'level':0x9}});_0xe85b04['on'](_0x50d111(0x2c2),()=>_0x4b1d48()),_0xa161e4['on'](_0x50d111(0x1d0),_0x1d67b3=>_0x18dde0(_0x1d67b3)),_0xa161e4['pipe'](_0xe85b04),_0xa161e4[_0x50d111(0x1d2)](_0x492aaa,![]),_0xa161e4[_0x50d111(0x17f)]();});}export async function archiveFolder(_0x48a086){const _0x3bdf3e=a0_0x4e242d;if(!a0_0x3894ec[_0x3bdf3e(0x1f8)](_0x48a086)||!a0_0x3894ec['statSync'](_0x48a086)[_0x3bdf3e(0x17e)]()){console['error'](_0x3bdf3e(0x27f),_0x48a086);return;}let _0x21daf5=a0_0x530a98['basename'](_0x48a086),_0x384cfa=transliterate(_0x21daf5)[_0x3bdf3e(0x194)](/[^a-zA-Z0-9_-]/g,'');if(!_0x384cfa)_0x384cfa='ArchivedFolder';const _0x6e1709=a0_0x530a98[_0x3bdf3e(0x18d)](archiveDir,_0x384cfa+_0x3bdf3e(0x1ac)),_0x278b7c=_0x6e1709+_0x3bdf3e(0x2ee);!a0_0x3894ec[_0x3bdf3e(0x1f8)](archiveDir)&&a0_0x3894ec[_0x3bdf3e(0x16e)](archiveDir,{'recursive':!![]});try{console[_0x3bdf3e(0x2dc)](_0x3bdf3e(0x1ae)),await zipFolder(_0x48a086,_0x6e1709),console[_0x3bdf3e(0x2dc)](_0x3bdf3e(0x300));const _0xf1ee99=a0_0x43b257[_0x3bdf3e(0x175)](_0x3bdf3e(0x1d8),encryptionKey,Buffer[_0x3bdf3e(0x2ab)](0x10,0x0)),_0x12f4da=a0_0x3894ec['createReadStream'](_0x6e1709),_0xfd142=a0_0x3894ec[_0x3bdf3e(0x295)](_0x278b7c);_0x12f4da[_0x3bdf3e(0x28b)](_0xf1ee99)[_0x3bdf3e(0x28b)](_0xfd142),_0xfd142['on'](_0x3bdf3e(0x2be),()=>{const _0x427955=_0x3bdf3e;console[_0x427955(0x2dc)](_0x427955(0x2d4),_0x278b7c);a0_0x3894ec[_0x427955(0x1f8)](_0x6e1709)&&(a0_0x3894ec[_0x427955(0x267)](_0x6e1709),console[_0x427955(0x2dc)](_0x427955(0x287),_0x6e1709));const _0x45800d=a0_0x3894ec['statSync'](_0x278b7c)[_0x427955(0x183)];db[_0x427955(0x19b)](_0x427955(0x1fb),[_0x384cfa,_0x427955(0x19e),_0x45800d,_0x48a086,_0x278b7c,encryptionKey[_0x427955(0x25c)](_0x427955(0x29a)),null],function(_0x589aa1){const _0x97d26a=_0x427955;_0x589aa1?console[_0x97d26a(0x1d0)](_0x97d26a(0x214),_0x589aa1['message']):(console[_0x97d26a(0x2dc)](_0x97d26a(0x2cb)+this[_0x97d26a(0x2bc)]+')'),updateExcelFile({'file_name':_0x384cfa,'file_extension':_0x97d26a(0x19e),'file_size':_0x45800d,'original_path':_0x48a086,'archived_path':_0x278b7c,'archive_date':new Date()[_0x97d26a(0x301)](_0x97d26a(0x203))}));});}),_0xfd142['on'](_0x3bdf3e(0x1d0),_0x427c97=>{const _0x3343c7=_0x3bdf3e;console[_0x3343c7(0x1d0)](_0x3343c7(0x1f5),_0x427c97[_0x3343c7(0x25d)]);});}catch(_0x34d25a){console[_0x3bdf3e(0x1d0)](_0x3bdf3e(0x247),_0x34d25a[_0x3bdf3e(0x25d)]);}}async function listArchivedFiles(){const _0x37058d=a0_0x4e242d,_0x3a7376=a0_0xdc16eb(_0x37058d(0x2a9))[_0x37058d(0x193)](),_0x466d24=[];db[_0x37058d(0x16f)](_0x37058d(0x25f),(_0x2b434b,_0x22de1f)=>{const _0x27003a=_0x37058d;if(_0x2b434b){_0x3a7376['fail'](_0x27003a(0x299)+_0x2b434b[_0x27003a(0x25d)]);return;}_0x466d24['push']([_0x22de1f['id']?.['toString']()||'',_0x22de1f['file_name']||'',_0x22de1f[_0x27003a(0x1ba)]||'',_0x22de1f[_0x27003a(0x269)]?(_0x22de1f[_0x27003a(0x269)]/0x400)['toFixed'](0x2)+_0x27003a(0x205):'',_0x22de1f[_0x27003a(0x293)]||'',_0x22de1f['archived_path']||'']);},(_0x2dc2dd,_0x483cbf)=>{const _0x9c8bfe=_0x37058d;if(_0x2dc2dd){_0x3a7376['fail'](_0x9c8bfe(0x1d4)+_0x2dc2dd['message']);return;}_0x3a7376[_0x9c8bfe(0x2af)](_0x9c8bfe(0x24a)+_0x483cbf+_0x9c8bfe(0x2e2));if(_0x483cbf===0x0){console['log']('📂\x20No\x20archived\x20files\x20found.');return;}terminal[_0x9c8bfe(0x20b)](),terminal[_0x9c8bfe(0x19a)]([['ID',_0x9c8bfe(0x187),_0x9c8bfe(0x2e9),_0x9c8bfe(0x265),'Date\x20Archived',_0x9c8bfe(0x29d)],..._0x466d24],{'hasBorder':!![],'borderChars':_0x9c8bfe(0x1bf),'width':terminal[_0x9c8bfe(0x21c)]-0x2,'fit':!![]}),terminal('\x0aUse\x20↑\x20↓\x20to\x20scroll,\x20Press\x20\x27q\x27\x20to\x20exit.\x0a'),terminal[_0x9c8bfe(0x230)]({'mouse':_0x9c8bfe(0x2d6)}),terminal['on']('key',_0x16128a=>{const _0x5589dc=_0x9c8bfe;_0x16128a==='q'&&(terminal(_0x5589dc(0x1e0)),process[_0x5589dc(0x1a1)]());});});}async function restoreFile(_0x1685e9){const _0x390532=a0_0x4e242d;db[_0x390532(0x20c)](_0x390532(0x21d),[_0x1685e9],async(_0x106a47,_0x53425d)=>{const _0x54f277=_0x390532;if(_0x106a47){console[_0x54f277(0x1d0)]('❌\x20Error\x20retrieving\x20file:',_0x106a47[_0x54f277(0x25d)]);return;}if(!_0x53425d){console['log'](_0x54f277(0x275));return;}const _0x19c2cb=_0x53425d[_0x54f277(0x2ce)],_0xf59989=_0x53425d[_0x54f277(0x2ae)],_0x56fb20=Buffer['from'](_0x53425d[_0x54f277(0x245)],'hex');try{await decryptFile(_0x19c2cb,_0xf59989,_0x56fb20,null,!![]),a0_0x3894ec[_0x54f277(0x267)](_0x19c2cb),db[_0x54f277(0x19b)]('DELETE\x20FROM\x20archived_files\x20WHERE\x20id\x20=\x20?',[_0x1685e9],_0x2db646=>{const _0xc3d8a1=_0x54f277;_0x2db646?console[_0xc3d8a1(0x1d0)](_0xc3d8a1(0x195),_0x2db646[_0xc3d8a1(0x25d)]):console[_0xc3d8a1(0x2dc)]('✅\x20File\x20restored\x20successfully\x20and\x20decrypted:\x20'+_0xf59989);});}catch(_0x52db8f){console[_0x54f277(0x1d0)](_0x54f277(0x255),_0x52db8f);}});}async function deleteFile(_0x4e0b21){const _0x54da6a=a0_0x4e242d;db[_0x54da6a(0x20c)](_0x54da6a(0x207),[_0x4e0b21],async(_0x39cd12,_0x563dad)=>{const _0x53c2aa=_0x54da6a;if(_0x39cd12){console[_0x53c2aa(0x1d0)](_0x53c2aa(0x1de),_0x39cd12[_0x53c2aa(0x25d)]);return;}if(!_0x563dad){console[_0x53c2aa(0x2dc)]('❌\x20File\x20not\x20found.');return;}const {confirm:_0x484fe5}=await a0_0x2cb607[_0x53c2aa(0x1c7)]([{'type':_0x53c2aa(0x2f8),'name':_0x53c2aa(0x2f8),'message':a0_0x5803c9[_0x53c2aa(0x181)]('⚠️\x20Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20file\x20permanently?'),'default':![]}]);if(!_0x484fe5){console[_0x53c2aa(0x2dc)](_0x53c2aa(0x307));return;}try{a0_0x3894ec[_0x53c2aa(0x267)](_0x563dad[_0x53c2aa(0x2ce)]),db['run'](_0x53c2aa(0x188),[_0x4e0b21],_0x2d3676=>{const _0x13a500=_0x53c2aa;_0x2d3676?console[_0x13a500(0x1d0)](_0x13a500(0x195),_0x2d3676['message']):console['log'](_0x13a500(0x28f));});}catch(_0x52ef83){console[_0x53c2aa(0x1d0)](_0x53c2aa(0x1fc),_0x52ef83);}});}function printTitle(){const _0x21b9be=a0_0x4e242d;console[_0x21b9be(0x20b)](),console[_0x21b9be(0x2dc)](a0_0x5abf25[_0x21b9be(0x2c5)][_0x21b9be(0x172)](a0_0x58c86a[_0x21b9be(0x1f0)](_0x21b9be(0x1e5),{'font':_0x21b9be(0x2ca),'horizontalLayout':'full','verticalLayout':_0x21b9be(0x237)}))),console[_0x21b9be(0x2dc)](a0_0x52afa4(a0_0x5803c9[_0x21b9be(0x2ba)]['white']('Information\x20Security\x20and\x20Data\x20Archiving\x20Module\x20ensures\x20secure\x20data\x20management\x20and\x20archiving\x20in\x20the\x20File\x20Management\x20System!'),{'padding':0x1,'margin':0.5,'backgroundColor':'black','borderStyle':'bold','borderColor':_0x21b9be(0x20e),'align':'center'}));const _0x22e092=new Date(),_0x203204=_0x22e092[_0x21b9be(0x2ad)](_0x21b9be(0x203)),_0x3524e2=_0x22e092[_0x21b9be(0x2bd)](_0x21b9be(0x203)),_0x1abc4c='\x20'+_0x203204+'\x20\x20'+_0x3524e2,_0x30323c=getArchiveStats();let _0x447c48='';_0x30323c?_0x447c48=_0x21b9be(0x21f)+_0x30323c[_0x21b9be(0x29e)]+'\x20|\x20PDF:\x20'+_0x30323c[_0x21b9be(0x1f9)][_0x21b9be(0x2e6)]+_0x21b9be(0x26e)+_0x30323c['types'][_0x21b9be(0x28a)]+_0x21b9be(0x21e)+_0x30323c['types'][_0x21b9be(0x19f)]+_0x21b9be(0x22e)+(_0x30323c[_0x21b9be(0x1f9)][_0x21b9be(0x1ea)]+_0x30323c['types']['xls'])+_0x21b9be(0x2c0)+(_0x30323c[_0x21b9be(0x1f9)][_0x21b9be(0x306)]+_0x30323c[_0x21b9be(0x1f9)]['jpeg'])+_0x21b9be(0x2a0)+_0x30323c[_0x21b9be(0x1f9)][_0x21b9be(0x1fe)]:_0x447c48=_0x21b9be(0x18b);const _0x28f7da=getArchiveSize();console[_0x21b9be(0x2dc)](a0_0x52afa4(a0_0x5803c9[_0x21b9be(0x2ba)][_0x21b9be(0x2f9)](_0x447c48+_0x21b9be(0x178)+_0x28f7da+_0x21b9be(0x185)+_0x1abc4c),{'padding':0.5,'margin':0x1,'backgroundColor':'black','borderStyle':_0x21b9be(0x2ba),'borderColor':'cyan','align':_0x21b9be(0x262)})),console[_0x21b9be(0x2dc)](a0_0x5803c9[_0x21b9be(0x2c1)](a0_0x5abf25([_0x21b9be(0x2da),_0x21b9be(0x1d7),'#FFFF00'])(_0x21b9be(0x21a))));}function getArchiveSize(){const _0xea4184=a0_0x4e242d;let _0x1aab4e=0x0;const _0x31b83a=_0xea4184(0x238),_0x39ac6c=a0_0x3894ec[_0xea4184(0x284)](_0x31b83a);return _0x39ac6c[_0xea4184(0x2c4)](_0x358e3c=>{const _0x4bb6d5=_0xea4184,_0xc9d5df=a0_0x530a98[_0x4bb6d5(0x18d)](_0x31b83a,_0x358e3c),_0x4bce8c=a0_0x3894ec[_0x4bb6d5(0x2dd)](_0xc9d5df);_0x4bce8c[_0x4bb6d5(0x1ee)]()&&(_0x1aab4e+=_0x4bce8c[_0x4bb6d5(0x183)]);}),(_0x1aab4e/(0x400*0x400))[_0xea4184(0x1db)](0x2);}const archiveDirectory=a0_0x530a98[a0_0x4e242d(0x212)](__dirname,'archive');function getArchiveStats(){const _0x553157=a0_0x4e242d,_0x43c4d1=getArchiveFiles();if(_0x43c4d1['length']===0x0)return null;const _0x3186a9={'pdf':0x0,'docx':0x0,'txt':0x0,'xlsx':0x0,'xls':0x0,'jpg':0x0,'jpeg':0x0,'other':0x0};return _0x43c4d1[_0x553157(0x2c4)](_0x47fa5e=>{const _0x50ad80=_0x553157,_0x469001=_0x47fa5e[_0x50ad80(0x194)](/\.enc$/,''),_0x2d56f2=a0_0x530a98[_0x50ad80(0x1cd)](_0x469001)[_0x50ad80(0x200)]();if(_0x2d56f2===_0x50ad80(0x2e5))_0x3186a9[_0x50ad80(0x2e6)]++;else{if(_0x2d56f2==='.docx')_0x3186a9['docx']++;else{if(_0x2d56f2==='.txt')_0x3186a9[_0x50ad80(0x19f)]++;else{if(_0x2d56f2===_0x50ad80(0x241))_0x3186a9[_0x50ad80(0x1ea)]++;else{if(_0x2d56f2===_0x50ad80(0x250))_0x3186a9[_0x50ad80(0x2f6)]++;else{if(_0x2d56f2===_0x50ad80(0x28c))_0x3186a9[_0x50ad80(0x306)]++;else{if(_0x2d56f2===_0x50ad80(0x1fd))_0x3186a9[_0x50ad80(0x2de)]++;else _0x3186a9[_0x50ad80(0x1fe)]++;}}}}}}}),{'total':_0x43c4d1[_0x553157(0x1b7)],'types':_0x3186a9};}function getArchiveFiles(){const _0x11392f=a0_0x4e242d;try{const _0x4552d3=a0_0x3894ec['readdirSync'](archiveDirectory);return _0x4552d3[_0x11392f(0x2f7)](_0x36bbd1=>a0_0x3894ec['statSync'](a0_0x530a98[_0x11392f(0x18d)](archiveDirectory,_0x36bbd1))[_0x11392f(0x1ee)]());}catch(_0x271612){return console['error'](a0_0x5803c9[_0x11392f(0x181)](_0x11392f(0x285),_0x271612)),[];}}async function requestPassword(){const _0xad03d3=a0_0x4e242d,_0x423748=JSON['parse'](a0_0x3894ec[_0xad03d3(0x2f5)](passwordFile,_0xad03d3(0x1c6))),_0x11eae3=_0x423748[_0xad03d3(0x297)],_0x4c2a13=decrypt(_0x11eae3),{password:_0x5f5ac8}=await a0_0x2cb607[_0xad03d3(0x1c7)]([{'type':_0xad03d3(0x297),'name':_0xad03d3(0x297),'message':a0_0x5803c9['green'](_0xad03d3(0x23a)),'mask':'*'}]);_0x5f5ac8!==_0x4c2a13&&(console['log'](a0_0x5803c9[_0xad03d3(0x242)](_0xad03d3(0x261))),process[_0xad03d3(0x1a1)]());}async function changePassword(){const _0x52c78a=a0_0x4e242d,_0x1d6735=JSON['parse'](a0_0x3894ec[_0x52c78a(0x2f5)](passwordFile,_0x52c78a(0x1c6))),_0x1db07e=_0x1d6735[_0x52c78a(0x297)],_0x4b50c1=decrypt(_0x1db07e),{oldPassword:_0x7fc16c}=await a0_0x2cb607['prompt']([{'type':'password','name':_0x52c78a(0x25b),'message':a0_0x5803c9['green'](_0x52c78a(0x2d0)),'mask':'*'}]);if(_0x7fc16c!==_0x4b50c1){console[_0x52c78a(0x2dc)](a0_0x5803c9['red'](_0x52c78a(0x177)));return;}const {newPassword:_0x1ac8f0,confirmPassword:_0x18e582}=await a0_0x2cb607[_0x52c78a(0x1c7)]([{'type':_0x52c78a(0x297),'name':_0x52c78a(0x190),'message':a0_0x5803c9[_0x52c78a(0x1b8)](_0x52c78a(0x1df)),'mask':'*'},{'type':'password','name':'confirmPassword','message':a0_0x5803c9[_0x52c78a(0x1b8)](_0x52c78a(0x239)),'mask':'*'}]);if(_0x1ac8f0!==_0x18e582){console[_0x52c78a(0x2dc)](a0_0x5803c9[_0x52c78a(0x181)](_0x52c78a(0x1ce)));return;}_0x1d6735[_0x52c78a(0x297)]=encrypt(_0x1ac8f0),a0_0x3894ec[_0x52c78a(0x278)](passwordFile,JSON[_0x52c78a(0x1e6)](_0x1d6735,null,0x2),_0x52c78a(0x1c6)),console[_0x52c78a(0x2dc)](a0_0x5803c9[_0x52c78a(0x1b8)](_0x52c78a(0x281)));}async function convertImageToPdf(_0x330f0e,_0x165b01){const _0x1a2ffd=a0_0x4e242d,_0x1ddfcc=await a0_0x8bc87a(_0x330f0e)[_0x1a2ffd(0x18c)](),_0x271c54=await PDFDocument[_0x1a2ffd(0x201)](),_0x4ba6b2=_0x271c54[_0x1a2ffd(0x1a0)]([0x258,0x320]),_0x154c10=await _0x271c54[_0x1a2ffd(0x1be)](_0x1ddfcc);_0x4ba6b2[_0x1a2ffd(0x27e)](_0x154c10,{'x':0x0,'y':0x0,'width':_0x4ba6b2[_0x1a2ffd(0x1b4)](),'height':_0x4ba6b2[_0x1a2ffd(0x1a6)]()});const _0x515a7c=await _0x271c54['save']();a0_0x3894ec['writeFileSync'](_0x165b01,_0x515a7c),console[_0x1a2ffd(0x2dc)](_0x1a2ffd(0x243)+_0x165b01);}async function convertPdfToDocx(_0x3aef41){const _0x2153fe=a0_0x4e242d;if(!a0_0x3894ec[_0x2153fe(0x1f8)](_0x3aef41)){console[_0x2153fe(0x1d0)]('❌\x20Error:\x20The\x20file\x20is\x20not\x20found\x20at\x20the\x20path:\x20'+_0x3aef41);return;}const _0x316946=a0_0x530a98['extname'](_0x3aef41)[_0x2153fe(0x200)]();if(_0x316946==='.xlsx'){const _0x3c2b65=a0_0x325c77[_0x2153fe(0x257)](_0x3aef41),_0x541083=_0x3c2b65['SheetNames'][0x0],_0xfc3b17=_0x3c2b65['Sheets'][_0x541083],_0x11692b=a0_0x325c77['utils']['sheet_to_json'](_0xfc3b17),_0x4928e5=_0x11692b['map']((_0x1451f0,_0x91578c)=>({'id':_0x91578c+0x1,'name':_0x1451f0[_0x2153fe(0x2f2)]||'','phone':_0x1451f0['📞\x20الهاتف']||'','email':_0x1451f0[_0x2153fe(0x2e3)]||'','qualification':_0x1451f0[_0x2153fe(0x2ed)]||'','job':_0x1451f0[_0x2153fe(0x220)]||'','course':_0x1451f0[_0x2153fe(0x18f)]||'','duration':_0x1451f0[_0x2153fe(0x1f4)]||'','type':_0x1451f0[_0x2153fe(0x216)]||'','datetime':_0x1451f0[_0x2153fe(0x2a7)]||''})),_0x104c94=_0x3aef41[_0x2153fe(0x194)](/\.xlsx$/,_0x2153fe(0x2b9));a0_0x3894ec[_0x2153fe(0x278)](_0x104c94,JSON[_0x2153fe(0x1e6)](_0x4928e5,null,0x2)),console['log']('✅\x20Excel\x20converted\x20to\x20mapped\x20JSON:\x20'+_0x104c94);return;}if([_0x2153fe(0x28c),_0x2153fe(0x1fd),_0x2153fe(0x219),_0x2153fe(0x1ec),'.bmp'][_0x2153fe(0x292)](_0x316946)){const _0x3e3b25=_0x3aef41[_0x2153fe(0x194)](_0x316946,_0x2153fe(0x2e5));await convertImageToPdf(_0x3aef41,_0x3e3b25),_0x3aef41=_0x3e3b25;}const _0x584f04=_0x3aef41[_0x2153fe(0x194)](/\.pdf$/,'.docx'),_0x3cafe7=a0_0x3894ec[_0x2153fe(0x2f5)](_0x3aef41),_0x461393=await a0_0x3c400b(_0x3cafe7),_0x273d72=_0x461393[_0x2153fe(0x1b9)]['trim'](),_0x531bbe=_0x273d72['split']('\x0a')['filter'](_0x2b285c=>_0x2b285c[_0x2153fe(0x2a8)]()!==''),_0x240657=new Document({'sections':[{'properties':{},'children':_0x531bbe[_0x2153fe(0x1b5)](_0x242c02=>{const _0x36c937=_0x2153fe,_0x531a69=_0x242c02['includes'](':')||_0x242c02[_0x36c937(0x2a1)]('\x20')[_0x36c937(0x1b7)]<=0x5;return new Paragraph({'bidirectional':!![],'children':[new TextRun({'text':_0x242c02,'bold':_0x531a69,'size':_0x531a69?0x20:0x1a,'font':'Arial'})],'spacing':{'after':_0x531a69?0xfa:0x96}});})}]}),_0x4d5af2=await Packer['toBuffer'](_0x240657);a0_0x3894ec['writeFileSync'](_0x584f04,_0x4d5af2),console[_0x2153fe(0x2dc)](_0x2153fe(0x1a3)+_0x584f04);}export async function mainMenu(){const _0x2526e1=a0_0x4e242d;while(!![]){printTitle();const {action:_0x4b292c}=await a0_0x2cb607[_0x2526e1(0x1c7)]([{'type':'list','name':'action','prefix':'\x20','message':'','choices':[{'key':'A','name':'\x1b[1m\x1b[33m[1]\x20[A]\x20Archive\x20a\x20Secure\x20File\x1b[0m','value':_0x2526e1(0x2f4)},{'key':'AF','name':_0x2526e1(0x246),'value':_0x2526e1(0x264)},{'key':'L','name':_0x2526e1(0x1f2),'value':_0x2526e1(0x2aa)},{'key':'S','name':_0x2526e1(0x199),'value':_0x2526e1(0x282)},{'key':'SI','name':_0x2526e1(0x2ff),'value':_0x2526e1(0x1d5)},{'key':'C','name':_0x2526e1(0x197),'value':_0x2526e1(0x1c0)},{'key':_0x2526e1(0x2e0),'name':_0x2526e1(0x308),'value':_0x2526e1(0x2e8)},{'key':'O','name':'\x1b[1m\x1b[38;5;223m[8]\x20[O]\x20Open\x20a\x20file\x1b[0m','value':_0x2526e1(0x263)},{'key':'R','name':_0x2526e1(0x2ec),'value':_0x2526e1(0x248)},{'key':'X','name':_0x2526e1(0x236),'value':_0x2526e1(0x228)},{'key':'B','name':_0x2526e1(0x303),'value':'backup'},{'key':'DB','name':_0x2526e1(0x229),'value':_0x2526e1(0x2e4)},{'key':'P','name':_0x2526e1(0x1af),'value':_0x2526e1(0x1e7)},{'key':'E','name':_0x2526e1(0x1fa),'value':_0x2526e1(0x1a1)}],'pageSize':0xc,'loop':![]}]);console[_0x2526e1(0x2dc)](a0_0x5803c9[_0x2526e1(0x1f1)](_0x2526e1(0x23e)));if(_0x4b292c===_0x2526e1(0x2f4))console['log'](a0_0x5803c9[_0x2526e1(0x242)](_0x2526e1(0x1d6))),await openFilePicker(archiveFile);else{if(_0x4b292c==='archiveFolder'){console['log'](a0_0x5803c9[_0x2526e1(0x242)](_0x2526e1(0x1ff)));try{const _0x127a36=await openFolderPicker();await archiveFolder(_0x127a36),console[_0x2526e1(0x2dc)](a0_0x5803c9[_0x2526e1(0x1b8)](_0x2526e1(0x283)));}catch(_0x328204){console['error'](a0_0x5803c9[_0x2526e1(0x181)](_0x328204[_0x2526e1(0x25d)]));}}else{if(_0x4b292c===_0x2526e1(0x2aa))console['log'](a0_0x5803c9[_0x2526e1(0x20e)](_0x2526e1(0x1ad))),listArchivedFiles();else{if(_0x4b292c===_0x2526e1(0x282))console[_0x2526e1(0x2dc)](a0_0x5803c9[_0x2526e1(0x1b8)](_0x2526e1(0x1f7))),await searchFiles();else{if(_0x4b292c===_0x2526e1(0x1d5))console[_0x2526e1(0x2dc)](a0_0x5803c9[_0x2526e1(0x2a3)](_0x2526e1(0x213))),await searchInsideFile();else{if(_0x4b292c===_0x2526e1(0x1c0))console['log'](a0_0x5803c9[_0x2526e1(0x1ca)](_0x2526e1(0x298))),await openFilePicker(convertPdfToDocx);else{if(_0x4b292c===_0x2526e1(0x2e8)){console['log'](a0_0x5803c9['cyanBright']('\x0a🖼️\x20Creating\x20PDF\x20from\x20images...\x0a'));const {folderPath:_0xa090f,outputPdf:_0x2503a3}=await a0_0x2cb607['prompt']([{'type':_0x2526e1(0x251),'name':_0x2526e1(0x17b),'message':_0x2526e1(0x215),'default':_0x2526e1(0x206)},{'type':_0x2526e1(0x251),'name':_0x2526e1(0x1ab),'message':'Enter\x20the\x20output\x20PDF\x20file\x20path:','default':'./scanner_output/scanned_output.pdf'}]);try{!a0_0x3894ec[_0x2526e1(0x1f8)](_0xa090f)?console['log'](a0_0x5803c9[_0x2526e1(0x181)](_0x2526e1(0x27d))):(await createPdfFromImages(_0xa090f,_0x2503a3),console[_0x2526e1(0x2dc)](a0_0x5803c9[_0x2526e1(0x1b8)](_0x2526e1(0x17c)+_0x2503a3)));}catch(_0x2db5bb){console[_0x2526e1(0x1d0)](a0_0x5803c9[_0x2526e1(0x181)]('❌\x20Error\x20creating\x20PDF:'),_0x2db5bb['message']);}}else{if(_0x4b292c===_0x2526e1(0x263)){const {id:_0x1c1558}=await a0_0x2cb607['prompt']([{'type':_0x2526e1(0x251),'name':'id','message':a0_0x5803c9['blue'](_0x2526e1(0x1e8))}]);openFile(parseInt(_0x1c1558));}else{if(_0x4b292c==='restore'){const {id:_0x237d0c}=await a0_0x2cb607[_0x2526e1(0x1c7)]([{'type':'input','name':'id','message':a0_0x5803c9['yellow'](_0x2526e1(0x2bb))}]);restoreFile(parseInt(_0x237d0c));}else{if(_0x4b292c===_0x2526e1(0x228)){const {id:_0x50926d}=await a0_0x2cb607[_0x2526e1(0x1c7)]([{'type':_0x2526e1(0x251),'name':'id','message':a0_0x5803c9['red'](_0x2526e1(0x2ea))}]);deleteFile(parseInt(_0x50926d));}else{if(_0x4b292c==='changePassword')console[_0x2526e1(0x2dc)](a0_0x5803c9[_0x2526e1(0x1f1)](_0x2526e1(0x209))),await changePassword();else{if(_0x4b292c===_0x2526e1(0x2b0)){console[_0x2526e1(0x2dc)](a0_0x5803c9[_0x2526e1(0x2a5)](_0x2526e1(0x2c3)));const {backup:_0x54a3ec}=await a0_0x2cb607[_0x2526e1(0x1c7)]([{'type':_0x2526e1(0x2f8),'name':_0x2526e1(0x2b0),'message':_0x2526e1(0x232),'default':![]}]);if(_0x54a3ec){const _0x2ff5f7=a0_0x530a98[_0x2526e1(0x18d)](__dirname,_0x2526e1(0x2f4)),_0x30b245=_0x2526e1(0x2d5),_0x25d022=a0_0x530a98[_0x2526e1(0x18d)](_0x30b245,'archive_backup.tar.gz');!a0_0x3894ec['existsSync'](_0x30b245)&&a0_0x3894ec[_0x2526e1(0x16e)](_0x30b245,{'recursive':!![]});try{await c({'gzip':!![],'file':_0x25d022,'cwd':a0_0x530a98[_0x2526e1(0x1f3)](_0x2ff5f7)},[a0_0x530a98[_0x2526e1(0x189)](_0x2ff5f7)]),console['log'](a0_0x5803c9['green'](_0x2526e1(0x2b7)+_0x25d022));}catch(_0x4b35fc){console[_0x2526e1(0x1d0)](a0_0x5803c9[_0x2526e1(0x181)](_0x2526e1(0x2a4)+_0x4b35fc[_0x2526e1(0x25d)]));}}}else{if(_0x4b292c===_0x2526e1(0x2e4)){console['log'](a0_0x5803c9['magenta']('\x0a🛠️\x20Restoring\x20the\x20database...\x0a'));const {restoreDb:_0x569992}=await a0_0x2cb607['prompt']([{'type':_0x2526e1(0x2f8),'name':_0x2526e1(0x2e7),'message':_0x2526e1(0x2f1),'default':![]}]);_0x569992&&manageDatabase();}else console['log'](a0_0x5803c9[_0x2526e1(0x2a5)]('\x0a👋\x20Exiting...\x20Have\x20a\x20great\x20day!\x0a')),process[_0x2526e1(0x1a1)]();}}}}}}}}}}}}await a0_0x2cb607[_0x2526e1(0x1c7)]([{'type':_0x2526e1(0x251),'name':_0x2526e1(0x1aa),'message':a0_0x5803c9['gray'](_0x2526e1(0x22d))}]);}}async function createPdfFromImages(){const _0x532629=a0_0x4e242d,_0x1181b6=a0_0x530a98[_0x532629(0x18d)](a0_0x3cde69[_0x532629(0x173)](),_0x532629(0x22b)),_0x5d1d64=await a0_0x2cb607['prompt']([{'type':'input','name':_0x532629(0x1b0),'message':'Enter\x20the\x20folder\x20name\x20(inside\x20Desktop)\x20containing\x20images\x20or\x20PDFs:','default':'scanner_output'},{'type':_0x532629(0x251),'name':_0x532629(0x2db),'message':_0x532629(0x1ef),'default':_0x532629(0x1cf)}]),_0x10c973=a0_0x530a98[_0x532629(0x18d)](_0x1181b6,_0x5d1d64[_0x532629(0x1b0)]);!a0_0x3894ec[_0x532629(0x1f8)](_0x10c973)&&(a0_0x3894ec[_0x532629(0x16e)](_0x10c973,{'recursive':!![]}),console[_0x532629(0x2dc)]('✅\x20Created\x20folder:\x20'+_0x10c973));const _0x203bb2=a0_0x530a98['join'](_0x10c973,_0x5d1d64[_0x532629(0x2db)]),_0x5d3be6=a0_0x3894ec[_0x532629(0x284)](_0x10c973),_0x303865=_0x5d3be6[_0x532629(0x2f7)](_0x60cb00=>/\.(jpe?g|png)$/i[_0x532629(0x226)](_0x60cb00))['sort'](),_0x3ddaf1=_0x5d3be6[_0x532629(0x2f7)](_0x49fd1f=>/\.pdf$/i[_0x532629(0x226)](_0x49fd1f))[_0x532629(0x2e1)]();if(_0x303865[_0x532629(0x1b7)]===0x0&&_0x3ddaf1[_0x532629(0x1b7)]===0x0){console[_0x532629(0x2dc)](_0x532629(0x20d));return;}try{const _0x19b1bd=await PDFDocument[_0x532629(0x201)]();for(const _0x18c5c9 of _0x303865){const _0x95f864=a0_0x530a98[_0x532629(0x18d)](_0x10c973,_0x18c5c9),_0x38b83b=a0_0x3894ec['readFileSync'](_0x95f864);let _0x38b367;_0x18c5c9[_0x532629(0x200)]()['endsWith'](_0x532629(0x219))?_0x38b367=await _0x19b1bd[_0x532629(0x26d)](_0x38b83b):_0x38b367=await _0x19b1bd[_0x532629(0x1be)](_0x38b83b);const _0x110705=_0x19b1bd['addPage']([_0x38b367['width'],_0x38b367[_0x532629(0x2fd)]]);_0x110705[_0x532629(0x27e)](_0x38b367,{'x':0x0,'y':0x0,'width':_0x38b367['width'],'height':_0x38b367[_0x532629(0x2fd)]});}for(const _0x5d5318 of _0x3ddaf1){const _0x417aa7=a0_0x530a98[_0x532629(0x18d)](_0x10c973,_0x5d5318),_0x43e4cc=a0_0x3894ec['readFileSync'](_0x417aa7),_0x358222=await PDFDocument['load'](_0x43e4cc),_0x5befb0=await _0x19b1bd[_0x532629(0x22c)](_0x358222,_0x358222[_0x532629(0x174)]());_0x5befb0[_0x532629(0x2c4)](_0x1cd6b7=>_0x19b1bd[_0x532629(0x1a0)](_0x1cd6b7));}const _0x15c26e=await _0x19b1bd['save']();a0_0x3894ec['writeFileSync'](_0x203bb2,_0x15c26e),console[_0x532629(0x2dc)](_0x532629(0x2b8)+_0x203bb2);}catch(_0x41c056){console['error']('❌\x20Error\x20creating\x20PDF:',_0x41c056[_0x532629(0x25d)]);}}export function openFilePicker(_0x282bcc){const _0x421aff=a0_0x4e242d,_0x3ae6ec=_0x421aff(0x26c)['trim']()[_0x421aff(0x194)](/\n/g,';\x20');exec(_0x421aff(0x27b)+_0x3ae6ec+'\x22',{'encoding':'utf8'},(_0x5b99ac,_0x399e8a)=>{const _0x3b464c=_0x421aff;if(_0x5b99ac){console['error'](_0x3b464c(0x1a2),_0x5b99ac[_0x3b464c(0x25d)]);return;}const _0x45d5d0=_0x399e8a[_0x3b464c(0x2a1)](/\r?\n/)[_0x3b464c(0x1b5)](_0x5671ea=>_0x5671ea['trim']())[_0x3b464c(0x2f7)](_0x74fe2a=>_0x74fe2a&&a0_0x3894ec['existsSync'](_0x74fe2a));if(_0x45d5d0[_0x3b464c(0x1b7)]===0x0){console[_0x3b464c(0x2dc)](_0x3b464c(0x254));return;}_0x45d5d0['forEach'](_0x48b449=>{const _0x305282=_0x3b464c,_0x42dd3c=a0_0x530a98['dirname'](_0x48b449),_0x3aaa71=a0_0x530a98[_0x305282(0x1cd)](_0x48b449),_0x5593aa=a0_0x530a98[_0x305282(0x189)](_0x48b449,_0x3aaa71);let _0x596b69=transliterate(_0x5593aa)[_0x305282(0x194)](/[^a-zA-Z0-9]/g,'');if(!_0x596b69)_0x596b69='ConvertedFile';const _0x483074=a0_0x530a98[_0x305282(0x18d)](_0x42dd3c,_0x596b69+_0x3aaa71);a0_0x3894ec[_0x305282(0x19d)](_0x48b449,_0x483074,_0x8a3bd3=>{const _0x5f4181=_0x305282;if(_0x8a3bd3){console[_0x5f4181(0x1d0)](_0x5f4181(0x1d9),_0x8a3bd3[_0x5f4181(0x25d)]);return;}console['log'](_0x5f4181(0x1e2),_0x483074),_0x282bcc(_0x483074);});});});}export function openFolderPicker(){return new Promise((_0x24ba69,_0x2bfcf8)=>{const _0x58a5ea=a0_0x5c46,_0x36f057=_0x58a5ea(0x184)['trim']()['replace'](/\n/g,';\x20');exec('powershell\x20-NoProfile\x20-Command\x20\x22'+_0x36f057+'\x22',{'encoding':_0x58a5ea(0x1c6)},(_0x216d87,_0x45af94)=>{const _0x530c62=_0x58a5ea;if(_0x216d87)return _0x2bfcf8(_0x216d87);const _0x392507=_0x45af94[_0x530c62(0x2a8)]();if(!_0x392507||!a0_0x3894ec[_0x530c62(0x1f8)](_0x392507))return _0x2bfcf8(new Error());_0x24ba69(_0x392507);});});}async function extractTextFromFile(_0x3887b3){const _0x13bcb4=a0_0x4e242d,_0x29019c=a0_0x530a98[_0x13bcb4(0x1cd)](_0x3887b3)[_0x13bcb4(0x200)]();let _0x43b467='';try{if(_0x29019c===_0x13bcb4(0x252)){const {value:_0x385699}=await a0_0x31b209[_0x13bcb4(0x2df)]({'path':_0x3887b3});_0x43b467=_0x385699['toLowerCase']();}else{if(_0x29019c===_0x13bcb4(0x241)){const _0x3e6df3=a0_0x325c77[_0x13bcb4(0x257)](_0x3887b3),_0x5dadf3=_0x3e6df3[_0x13bcb4(0x182)];_0x5dadf3[_0x13bcb4(0x2c4)](_0x317afb=>{const _0x466de6=_0x13bcb4,_0x4d7264=a0_0x325c77[_0x466de6(0x309)][_0x466de6(0x2cc)](_0x3e6df3[_0x466de6(0x290)][_0x317afb],{'header':0x1});_0x43b467+=_0x4d7264['flat']()[_0x466de6(0x18d)]('\x20')[_0x466de6(0x200)]()+'\x20';});}else{if([_0x13bcb4(0x28c),'.jpeg',_0x13bcb4(0x219)][_0x13bcb4(0x292)](_0x29019c)){const {data:{text:_0x14995d}}=await recognize(_0x3887b3);_0x43b467=_0x14995d[_0x13bcb4(0x200)]();}else console[_0x13bcb4(0x1b1)](_0x13bcb4(0x1e4)+_0x3887b3);}}}catch(_0xe1c98c){console[_0x13bcb4(0x1d0)](_0x13bcb4(0x1c3)+_0x3887b3+':',_0xe1c98c['message']);}return _0x43b467;}if(!a0_0x3894ec[a0_0x4e242d(0x1f8)](tempDir))a0_0x3894ec[a0_0x4e242d(0x16e)](tempDir);async function searchInsideFile(){const _0x330a68=a0_0x4e242d;try{const {keywords:_0x172ee7}=await a0_0x2cb607['prompt']([{'type':'input','name':'keywords','message':a0_0x5803c9['cyan'](_0x330a68(0x26f))}]),_0x4905cc=_0x172ee7[_0x330a68(0x2a1)](',')[_0x330a68(0x1b5)](_0x53aff2=>_0x53aff2[_0x330a68(0x2a8)]()[_0x330a68(0x200)]());let _0x3877f8=[];const _0x2b05db=await getEncryptedFiles();let _0x325ac8=_0x330a68(0x1a4);_0x325ac8+=_0x330a68(0x2b2)+new Date()[_0x330a68(0x301)](_0x330a68(0x2b1))+')\x0a',_0x325ac8+=_0x330a68(0x1bd);for(const {id:_0x1403a6,encryptedFilePath:_0x447798,encryptionKey:_0x2f92ef,originalFileName:_0xccb73b}of _0x2b05db){const _0x4abec5=a0_0x530a98[_0x330a68(0x18d)](_0x330a68(0x2f4),_0xccb73b);try{await decryptFile(_0x447798,_0x4abec5,_0x2f92ef);if(!/\.(docx|xlsx|doc|xls)$/i[_0x330a68(0x226)](_0xccb73b))continue;let _0x597a6a='';try{_0x597a6a=await extractTextFromFile(_0x4abec5),_0x597a6a=_0x597a6a[_0x330a68(0x200)]();}catch(_0x15a4cf){continue;}const _0x261722=_0x4905cc[_0x330a68(0x196)](_0x2905be=>_0x597a6a[_0x330a68(0x292)](_0x2905be));if(_0x261722){_0x3877f8[_0x330a68(0x249)](_0xccb73b);const _0xa484cb=a0_0x3894ec['statSync'](_0x4abec5),_0x84251e=(_0xa484cb[_0x330a68(0x183)]/0x400)[_0x330a68(0x1db)](0x2),_0xdc48ad=a0_0x530a98['dirname'](_0x4abec5),_0x1003ec=_0x597a6a[_0x330a68(0x2a1)]('\x0a')['filter'](_0x1f42e6=>_0x1f42e6['trim']()!=='')[_0x330a68(0x204)](0x0,0x5)[_0x330a68(0x18d)]('\x0a');console['log'](a0_0x5803c9[_0x330a68(0x2d7)][_0x330a68(0x2ba)]('---------------------------------------')),console[_0x330a68(0x2dc)](a0_0x5803c9['bold']['green']('✅\x20Keywords\x20found\x20in:\x20'+_0xccb73b)),console[_0x330a68(0x2dc)](a0_0x5803c9['bold']['cyan']('---\x20File\x20Details\x20---')),console[_0x330a68(0x2dc)](a0_0x5803c9[_0x330a68(0x2d7)]['bold'](_0x330a68(0x244)+_0x1403a6+_0x330a68(0x256)+_0xccb73b+_0x330a68(0x2b6)+a0_0x530a98[_0x330a68(0x1cd)](_0xccb73b)+_0x330a68(0x277)+_0x84251e+_0x330a68(0x1c9)+_0xdc48ad)),console[_0x330a68(0x2dc)](a0_0x5803c9[_0x330a68(0x2d7)][_0x330a68(0x2ba)](_0x330a68(0x2cd))),_0x325ac8+='🆔\x20'+_0x1403a6+'\x0a',_0x325ac8+=_0x330a68(0x1e1)+_0xccb73b+'\x0a',_0x325ac8+=_0x330a68(0x1eb)+a0_0x530a98[_0x330a68(0x1cd)](_0xccb73b)+'\x0a',_0x325ac8+=_0x330a68(0x286)+_0x84251e+_0x330a68(0x291),_0x325ac8+=_0x330a68(0x1a8)+_0xdc48ad+'\x0a',_0x325ac8+=_0x330a68(0x24d)+(_0x597a6a[_0x330a68(0x2a1)]('\x0a')[_0x330a68(0x2f7)](_0x2a7f18=>_0x2a7f18[_0x330a68(0x2a8)]()!=='')['join'](_0x330a68(0x2c7))||_0x330a68(0x211))+'\x0a',_0x325ac8+=_0x330a68(0x223);}}catch(_0x3bb8db){}finally{a0_0x3894ec[_0x330a68(0x1f8)](_0x4abec5)&&a0_0x3894ec[_0x330a68(0x267)](_0x4abec5);}}if(_0x3877f8[_0x330a68(0x1b7)]===0x0)console[_0x330a68(0x2dc)](a0_0x5803c9['yellow'](_0x330a68(0x2b4)));else{const _0xb22142=_0x330a68(0x22a);a0_0x3894ec['writeFileSync'](_0xb22142,_0x325ac8,'utf8'),console[_0x330a68(0x2dc)](a0_0x5803c9[_0x330a68(0x29f)](_0x330a68(0x176)+_0xb22142));const {openFile:_0x3cc8a7}=await a0_0x2cb607[_0x330a68(0x1c7)]([{'type':_0x330a68(0x2f8),'name':_0x330a68(0x19c),'message':a0_0x5803c9[_0x330a68(0x20e)](_0x330a68(0x217)),'default':![]}]);_0x3cc8a7&&exec('\x22'+_0xb22142+'\x22',_0x2eab2d=>{const _0x28e051=_0x330a68;_0x2eab2d&&console[_0x28e051(0x1d0)](a0_0x5803c9[_0x28e051(0x181)](_0x28e051(0x24f)+_0xb22142));});}}catch(_0x4d242d){console[_0x330a68(0x1d0)](a0_0x5803c9['red'](_0x330a68(0x24e)),_0x4d242d[_0x330a68(0x25d)]);}}function getEncryptedFiles(){return new Promise((_0x2778b8,_0xe93b28)=>{const _0xe2cea4=a0_0x5c46;db[_0xe2cea4(0x302)](_0xe2cea4(0x1c2),[],(_0x3fdd20,_0x4b03ed)=>{const _0x3f908d=_0xe2cea4;if(_0x3fdd20)_0xe93b28(_0x3fdd20);else{const _0x16cad1=_0x4b03ed[_0x3f908d(0x1b5)](_0x40bf2b=>({'id':_0x40bf2b['id'],'encryptedFilePath':_0x40bf2b[_0x3f908d(0x2ce)],'encryptionKey':Buffer[_0x3f908d(0x192)](_0x40bf2b[_0x3f908d(0x245)],_0x3f908d(0x29a)),'originalFileName':a0_0x530a98[_0x3f908d(0x189)](_0x40bf2b['archived_path'],_0x3f908d(0x2ee))}));_0x2778b8(_0x16cad1);}});});}function calculateFileHash(_0x18fbe6){return new Promise((_0x4a9b8e,_0x46e79d)=>{const _0xfb1fc4=a0_0x5c46,_0x479216=a0_0x43b257[_0xfb1fc4(0x208)](_0xfb1fc4(0x1a5)),_0x42690f=a0_0x3894ec[_0xfb1fc4(0x234)](_0x18fbe6);_0x42690f['on'](_0xfb1fc4(0x258),_0x57cd01=>_0x479216[_0xfb1fc4(0x24c)](_0x57cd01)),_0x42690f['on'](_0xfb1fc4(0x305),()=>_0x4a9b8e(_0x479216['digest']('hex'))),_0x42690f['on']('error',_0x310c10=>_0x46e79d(_0x310c10));});}function decryptFile(_0x585df8,_0x47abe6,_0x473c14,_0x31658d=null,_0x3ec772=![]){return new Promise((_0x156e28,_0x1458c6)=>{const _0xac2d7c=a0_0x5c46;try{const _0xf41388=a0_0x43b257[_0xac2d7c(0x2ef)](_0xac2d7c(0x1d8),_0x473c14,Buffer[_0xac2d7c(0x2ab)](0x10,0x0)),_0x292a5f=a0_0x3894ec['createReadStream'](_0x585df8),_0x3ea538=a0_0x3894ec[_0xac2d7c(0x295)](_0x47abe6);_0x292a5f[_0xac2d7c(0x28b)](_0xf41388)[_0xac2d7c(0x28b)](_0x3ea538),_0x3ea538['on'](_0xac2d7c(0x2be),async()=>{const _0x4d6ba3=_0xac2d7c;if(_0x3ec772||!_0x31658d){_0x156e28();return;}try{const _0xd6d3dc=await calculateFileHash(_0x47abe6);_0xd6d3dc===_0x31658d?(console[_0x4d6ba3(0x2dc)](_0x4d6ba3(0x26a)),_0x156e28()):(console['warn']('⚠️\x20File\x20decrypted\x20but\x20hash\x20does\x20not\x20match!'),_0x1458c6(new Error('Decryption\x20succeeded\x20but\x20file\x20integrity\x20check\x20failed.')));}catch(_0x5a7269){_0x1458c6(_0x5a7269);}}),_0x3ea538['on'](_0xac2d7c(0x1d0),_0x4e1f5f=>_0x1458c6(_0x4e1f5f)),_0x292a5f['on'](_0xac2d7c(0x1d0),_0x6e6879=>_0x1458c6(_0x6e6879));}catch(_0x44dc12){_0x1458c6(_0x44dc12);}});}async function startApp(){await requestPassword(),await mainMenu();}startApp();